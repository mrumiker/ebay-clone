{% extends "auctions/layout.html" %}

{% block body %}

<h1>{{ featured_user }}'s Albums</h1>
{% if won %}
<h2>Albums Won by {{ featured_user }}</h2>
{% for album in won %}
<div class="card my-4" style="width: 26rem;">
  <img src="{{ album.image_url }}" class="card-img-top" alt="cover of {{ album }}">
  <div class="card-body">
    <h4 class="card-title">{{ album.title }}</h4>
    <h5 class="card-subtitle">{{ album.artist }}</h5>
  </div>
  <ul class="list-group list-group-flush">
    {% if user.id == album.top_bidder.id %}
    <li class="list-group-item" style="background-color: honeydew;"><b>SOLD TO YOU</b> for {{ album.top_bid }}!</li>
    {% else %}
    <li class="list-group-item"><b>SOLD</b> to {{ album.top_bidder }} for {{ album.top_bid }}</li>
    {% endif %}
    {% if user.id == album.seller.id %}
    <li class="list-group-item text-muted">Offered by <a href="{% url 'albums' user.id %}" class="card-link">you</a> on
      {{ album.datetime_created }}</li>
    {% else %}
    <li class="list-group-item text-muted">Offered by <a href="{% url 'albums' album.seller.id %}"
        class="card-link">{{album.seller}}</a> on {{ album.datetime_created }}</li>
    {% endif %}
  </ul>
  <div class="card-body">
    <a href="{% url 'listing' album.id %}" class="card-link">Go to Listing</a>
  </div>
</div>
{% endfor %}
{% endif %}

{% if selling %}
<h2>Albums Listed by {{ featured_user }}</h2>

{% for album in selling %}
<div class="card my-4" style="width: 26rem;">
  <img src="{{ album.image_url }}" class="card-img-top" alt="cover of {{ album }}">
  <div class="card-body">
    <h4 class="card-title">{{ album.title }}</h4>
    <h5 class="card-subtitle">{{ album.artist }}</h5>
  </div>
  <ul class="list-group list-group-flush">
    {% if album.top_bid %}
    {% if album.datetime_closed %}
    {% if user.id == album.top_bidder.id %}
    <li class="list-group-item" style="background-color: honeydew;"><b>SOLD TO <a href="{% url 'albums' user.id %}"
          class="card-link text-danger">YOU</a></b> for {{ album.top_bid }}!</li>
    {% else %}
    <li class="list-group-item"><b>SOLD</b> to <a href="{% url 'albums' album.top_bidder.id %}"
        class="card-link">{{album.top_bidder}}</a> for {{ album.top_bid }}</li>
    {% endif %}
    {% else %}
    {% if user.id == album.top_bidder.id %}
    <li class="list-group-item" style="background-color: honeydew;">Current bid is <b>{{ album.top_bid }}</b> by <a
        href="{% url 'albums' user.id %}" class="card-link">you</a>
    </li>
    {% else %}
    <li class="list-group-item">Current bid is <b>{{ album.top_bid }}</b> by <a
        href="{% url 'albums' album.top_bidder.id %}" class="card-link">{{album.top_bidder}}</a></li>
    {% endif %}
    {% endif %}
    {% elif album.datetime_closed %}
    {% if user == album.seller %}
    <li class="list-group-item text-muted">Withdrawn by you on {{album.datetime_closed}}</li>
    {% else %}
    <li class="list-group-item text-muted">Withdrawn by {{ album.seller }} on {{ album.datetime_closed }}</li>
    {% endif %}
    {% else %}
    {% if user.id == album.seller.id %}
    <li class="list-group-item text-muted">Offered by you on
      {{album.datetime_created}}</li>
    {% else %}
    <li class="list-group-item text-muted">Offered by {{ album.seller }} on {{ album.datetime_created }}</li>
    {% endif %}
    {% endif %}
  </ul>
  <div class="card-body">
    <a href="{% url 'listing' album.id %}" class="card-link">Go to Listing</a>
  </div>
</div>
{% endfor %}
{% endif %}

{% if not won and not selling%}
<h6>Nothing here yet!</h6>
{% endif %}
{% endblock %}